<p>A quick re-cap of where we are so far in our OData OMeta Adventure.</p>

<ul>
<li><a href="/entries/building-a-basic-json-parser-in-ometa.html">Learning OMeta through JSON</a></li>
<li><a href="/entries/building-an-odata-parser-in-ometa.html">Introduction to the OData Parser</a></li>
<li><a href="/entries/writing-an-odata-parser---starting-at-the-beginning.html">First steps in writing the OData Parser</a></li>
<li><a href="/entries/parsing-odata---nested-resource-paths.html">Nested resource paths in OData</a></li>
<li><a href="/entries/parsing-odata---service-operations.html">Service operations in OData</a></li>
<li><a href="/entries/the-odata-parser---applying-modifiers-to-our-query.html">Query options in OData</a></li>
<li><a href="/entries/paging-support-in-our-odata-parser.html">Paging support in OData</a></li>
<li><a href="/entries/our-odata-parser---looking-at-filterby.html">Filtering support in OData</a></li>
</ul>

<p><strong>CRIKEY</strong></p>

<p>Never thought I'd be writing this much about OMeta, but I've taken quite the shine to it.</p>

<p>I want to add this stuff to my $filterby parser now.</p>

<pre><code>Add        Addition                /Products?$filter=Price add 5 gt 10
Sub        Subtraction             /Products?$filter=Price sub 5 gt 10
Mul        Multiplication          /Products?$filter=Price mul 2 gt 2000
Div        Division                /Products?$filter=Price div 2 gt 4
Mod        Modulo                  /Products?$filter=Price mod 2 eq 0
</code></pre>

<p>Now here's the thing, the way we look at this <em>actually</em>, is that we have two expressions in each of these, and there is a precedence here too which needs respecting.</p>

<p>Anyway, what do we expect to see when we do this?</p>

<pre><code>test("/some/resource?$filter=Price add 5 gt 10", "OData", function(result) {
  it("A filter should be present", function() {
     assert.notEqual(result.options.$filterby, null)
  })
  it("Filter should be an instance of 'add'", function() {
     assert.equal(result.options.$filterby[0], "add")
  })

  it("lhr should be Price", function() {
     assert.equal(result.options.$filterby[1].name, "Price")
  })

  it("rhr should be lhs ", function() {
     assert.equal(result.options.$filterby[2], 2)
  })
})
</code></pre>